#!/usr/bin/env python
# encoding: utf-8
"""
Update repo, run installer and tell how to switch to zsh.
"""

from os import environ
from os.path import dirname, join, realpath
from subprocess import call


def _main():
    # get dotfiles directory
    dotfiles_dir = dirname(realpath(__file__))

    # update repo and "install" submodules
    call(' && '.join([
        'cd ' + dotfiles_dir,
        'git pull --rebase',
        'git submodule init',
        'git submodule update'
    ]), shell=True)

    # run installer
    installer = join(dotfiles_dir, 'installer/installer.py')
    call('python ' + installer, shell=True)

    # tell how to switch to zsh
    shell = environ.get('SHELL')
    if not shell or not shell.endswith('zsh'):
        print 'switch to zsh (you may need to relog): ' \
              'chsh -s `which zsh` $USER'

    # tell how to deal with mvim
    print 'run ":Helptags" in MacVim'
    print 'comment out /etc/zshenv contents to get correct $PATH in MacVim'

if __name__ == '__main__':
    _main()
